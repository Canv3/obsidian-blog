<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>你清楚 C# 怎么使用 Python 的东西吗 | PrintLove</title><meta name=keywords content><meta name=description content="本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单
去官网下载 IronPython，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言
打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll
using Microsoft.Scripting.Hosting; using IronPython.Hosting; //前面要导入两个名称空间 private void button1_Click(object sender, EventArgs e) { ScriptEngine pyEngine = Python.CreateEngine(); //建立python引擎 pyEngine.CreateScriptSourceFromFile(&#34;demo1.py&#34;).Execute(); //执行.py脚本 } 上面这个 &#34;demo1.py&#34; 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样） import sys sys.path.append(&#34;C:\IronPython 2.7\Lib&#34;)#看自己的Lib路径 调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py ScriptRuntime pyRuntime = Python.CreateRuntime(); dynamic obj = pyRuntime.UseFile(&#34;demo2.py&#34;); var a = obj."><meta name=author content="Evan Miao"><link rel=canonical href=https://www.jianshu.com/p/32e82f8d8395><link crossorigin=anonymous href=/assets/css/stylesheet.0f4d06feb7a00553d7b46603ca44aaca1dd036cd7082d6cecf39137242c0cb9e.css integrity="sha256-D00G/regBVPXtGYDykSqyh3QNs1wgtbOzzkTckLAy54=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.printlove.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.printlove.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.printlove.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://www.printlove.cn/apple-touch-icon.png><link rel=mask-icon href=https://www.printlove.cn/safari_pinned_tab.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/style.css media=print onload='this.media="all"'><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?4bddc7ae6f2203e19017f349bdcc79c2",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-VE0D4BXTS2"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VE0D4BXTS2",{anonymize_ip:!1})}</script><meta property="og:title" content="你清楚 C# 怎么使用 Python 的东西吗"><meta property="og:description" content="本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单
去官网下载 IronPython，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言
打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll
using Microsoft.Scripting.Hosting; using IronPython.Hosting; //前面要导入两个名称空间 private void button1_Click(object sender, EventArgs e) { ScriptEngine pyEngine = Python.CreateEngine(); //建立python引擎 pyEngine.CreateScriptSourceFromFile(&#34;demo1.py&#34;).Execute(); //执行.py脚本 } 上面这个 &#34;demo1.py&#34; 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样） import sys sys.path.append(&#34;C:\IronPython 2.7\Lib&#34;)#看自己的Lib路径 调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py ScriptRuntime pyRuntime = Python.CreateRuntime(); dynamic obj = pyRuntime.UseFile(&#34;demo2.py&#34;); var a = obj."><meta property="og:type" content="article"><meta property="og:url" content="https://www.printlove.cn/csharp-python/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-06-02T14:52:30+08:00"><meta property="article:modified_time" content="2016-06-02T14:52:30+08:00"><meta property="og:site_name" content="PrintLove"><meta name=twitter:card content="summary"><meta name=twitter:title content="你清楚 C# 怎么使用 Python 的东西吗"><meta name=twitter:description content="本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单
去官网下载 IronPython，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言
打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll
using Microsoft.Scripting.Hosting; using IronPython.Hosting; //前面要导入两个名称空间 private void button1_Click(object sender, EventArgs e) { ScriptEngine pyEngine = Python.CreateEngine(); //建立python引擎 pyEngine.CreateScriptSourceFromFile(&#34;demo1.py&#34;).Execute(); //执行.py脚本 } 上面这个 &#34;demo1.py&#34; 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样） import sys sys.path.append(&#34;C:\IronPython 2.7\Lib&#34;)#看自己的Lib路径 调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py ScriptRuntime pyRuntime = Python.CreateRuntime(); dynamic obj = pyRuntime.UseFile(&#34;demo2.py&#34;); var a = obj."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.printlove.cn/posts/"},{"@type":"ListItem","position":2,"name":"你清楚 C# 怎么使用 Python 的东西吗","item":"https://www.printlove.cn/csharp-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"你清楚 C# 怎么使用 Python 的东西吗","name":"你清楚 C# 怎么使用 Python 的东西吗","description":"本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单\n去官网下载 IronPython，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言\n打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll\nusing Microsoft.Scripting.Hosting; using IronPython.Hosting; //前面要导入两个名称空间 private void button1_Click(object sender, EventArgs e) { ScriptEngine pyEngine = Python.CreateEngine(); //建立python引擎 pyEngine.CreateScriptSourceFromFile(\u0026#34;demo1.py\u0026#34;).Execute(); //执行.py脚本 } 上面这个 \u0026quot;demo1.py\u0026quot; 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样） import sys sys.path.append(\u0026#34;C:\\IronPython 2.7\\Lib\u0026#34;)#看自己的Lib路径 调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py ScriptRuntime pyRuntime = Python.CreateRuntime(); dynamic obj = pyRuntime.UseFile(\u0026#34;demo2.py\u0026#34;); var a = obj.","keywords":[],"articleBody":" 本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单\n去官网下载 IronPython，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言\n打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll\nusing Microsoft.Scripting.Hosting; using IronPython.Hosting; //前面要导入两个名称空间 private void button1_Click(object sender, EventArgs e) { ScriptEngine pyEngine = Python.CreateEngine(); //建立python引擎 pyEngine.CreateScriptSourceFromFile(\"demo1.py\").Execute(); //执行.py脚本 } 上面这个 \"demo1.py\" 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样） import sys sys.path.append(\"C:\\IronPython 2.7\\Lib\")#看自己的Lib路径 调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py ScriptRuntime pyRuntime = Python.CreateRuntime(); dynamic obj = pyRuntime.UseFile(\"demo2.py\"); var a = obj.ShutDown(1800); //调用脚本的ShutDown方法，1800时间单位为秒 if (a == 1) { Console.WriteLine(\"倒计时设置成功\"); } 下面是我调用的 python 文件 \"demo2.py\"，这段脚本实现了 windows 系统倒计时关机\nimport sys sys.path.append(\"C:\\IronPython 2.7\\Lib\") import os def ShutDown(delayTime): os.system('shutdown -s -t %d'%(delayTime)) return 1 然后成功！\n","wordCount":"99","inLanguage":"zh","datePublished":"2016-06-02T14:52:30+08:00","dateModified":"2016-06-02T14:52:30+08:00","author":[{"@type":"Person","name":"Evan Miao"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.printlove.cn/csharp-python/"},"publisher":{"@type":"Organization","name":"PrintLove","logo":{"@type":"ImageObject","url":"https://www.printlove.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.printlove.cn/ accesskey=h title="PrintLove (Alt + H)">PrintLove</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.printlove.cn/archives title=文章><span>文章</span></a></li><li><a href=https://www.printlove.cn/series title=系列><span>系列</span></a></li><li><a href=https://www.printlove.cn/sponsor title=赞助><span>赞助</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>你清楚 C# 怎么使用 Python 的东西吗</h1><div class=post-meta><span title='2016-06-02 14:52:30 +0800 CST'>2016-06-02</span>&nbsp;·&nbsp;Evan Miao&nbsp;|&nbsp;<a href=https://github.com/miaogaolin/workspace-obisidian-publisher/tree/main/content/posts/%e4%bd%a0%e6%b8%85%e6%a5%9ac%20sharp%e6%80%8e%e4%b9%88%e4%bd%bf%e7%94%a8python%e7%9a%84%e4%b8%9c%e8%a5%bf%e5%90%97.md rel="noopener noreferrer" target=_blank>指出问题</a></div></header><div class=post-content><blockquote><p>本次实验是 vs2010 版本以下（包括 vs2010）,我记得如果是高版本的话好像已经内置了，所以比较简单</p></blockquote><ol><li><p>去官网下载 <a href=http://ironpython.codeplex.com/>IronPython</a>，它是 IronPython 是一种在 NET 和 Mono 上实现的 Python 语言</p></li><li><p>打开 vs,添加两个引用，在 IronPython 的安装根目录下面选择 IronPython.dll 和 Microsoft.Scripting.dll</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c# data-lang=c#><span style=display:flex><span><span style=color:#66d9ef>using</span> Microsoft.Scripting.Hosting;  
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> IronPython.Hosting;  
</span></span><span style=display:flex><span><span style=color:#75715e>//前面要导入两个名称空间  </span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> button1_Click(<span style=color:#66d9ef>object</span> sender, EventArgs e)  
</span></span><span style=display:flex><span>  {  
</span></span><span style=display:flex><span>       ScriptEngine pyEngine = Python.CreateEngine();       <span style=color:#75715e>//建立python引擎  </span>
</span></span><span style=display:flex><span>       pyEngine.CreateScriptSourceFromFile(<span style=color:#e6db74>&#34;demo1.py&#34;</span>).Execute();      <span style=color:#75715e>//执行.py脚本   </span>
</span></span><span style=display:flex><span>  }  
</span></span></code></pre></div><ol start=3><li>上面这个 "demo1.py" 是你的 Python 脚本文件，如果想通过上面两句执行.py 文件必须，前提是你还要导入别的模块，就必须加入在最前面写入以下代码,还有要设置脚本属性中（vs 中右键）“复制到输出目录中”这一项，选择始终复制（所有脚本一样）</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys  
</span></span><span style=display:flex><span>sys<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;C:\IronPython 2.7\Lib&#34;</span>)<span style=color:#75715e>#看自己的Lib路径  </span>
</span></span></code></pre></div><ol start=4><li>调用 python 的方法//配置 python 的环境,另写一个脚本 demo2.py</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span>ScriptRuntime pyRuntime = Python.CreateRuntime();  
</span></span><span style=display:flex><span><span style=color:#66d9ef>dynamic</span> obj = pyRuntime.UseFile(<span style=color:#e6db74>&#34;demo2.py&#34;</span>);  
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> a = obj.ShutDown(<span style=color:#ae81ff>1800</span>);     <span style=color:#75715e>//调用脚本的ShutDown方法，1800时间单位为秒  </span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (a == <span style=color:#ae81ff>1</span>)  
</span></span><span style=display:flex><span>{  
</span></span><span style=display:flex><span>   Console.WriteLine(<span style=color:#e6db74>&#34;倒计时设置成功&#34;</span>);  
</span></span><span style=display:flex><span>}  
</span></span></code></pre></div><p>下面是我调用的 python 文件 "demo2.py"，这段脚本实现了 windows 系统倒计时关机</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> sys  
</span></span><span style=display:flex><span>sys<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>append(<span style=color:#e6db74>&#34;C:\IronPython 2.7\Lib&#34;</span>)  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os  
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ShutDown</span>(delayTime):  
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>&#39;shutdown -s -t </span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>%</span>(delayTime))  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>  
</span></span><span style=display:flex><span>  
</span></span></code></pre></div><p>然后成功！</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://www.printlove.cn/php-func-up/><span class=title>« 上一页</span><br><span>跟我学习php数组常用函数-上篇</span></a>
<a class=next href=https://www.printlove.cn/css3-class/><span class=title>下一页 »</span><br><span>认识css3伪元素</span></a></nav><div class=comment-head>评论 & Email：</div><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 你清楚 C# 怎么使用 Python 的东西吗 on x" href="https://x.com/intent/tweet/?text=@laomiao_ %e4%bd%a0%e6%b8%85%e6%a5%9a%20C%23%20%e6%80%8e%e4%b9%88%e4%bd%bf%e7%94%a8%20Python%20%e7%9a%84%e4%b8%9c%e8%a5%bf%e5%90%97&amp;url=https%3a%2f%2fwww.printlove.cn%2fcsharp-python%2f&amp;hashtags="><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 50 50" fill="currentcolor"><path d="M5.9199219 6 20.582031 27.375 6.2304688 44H9.4101562L21.986328 29.421875 31.986328 44H44L28.681641 21.669922 42.199219 6H39.029297L27.275391 19.617188 17.933594 6H5.9199219zm3.796875 2H16.880859L40.203125 42H33.039062L9.7167969 8z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 你清楚 C# 怎么使用 Python 的东西吗 on email" href="mailto:mglluoye@gmail.com?subject=%e4%bd%a0%e6%b8%85%e6%a5%9a%20C%23%20%e6%80%8e%e4%b9%88%e4%bd%bf%e7%94%a8%20Python%20%e7%9a%84%e4%b8%9c%e8%a5%bf%e5%90%97"><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 12C2 7.28595 2 4.92893 3.46447 3.46447 4.92893 2 7.28595 2 12 2c4.714.0 7.0711.0 8.5355 1.46447C22 4.92893 22 7.28595 22 12c0 4.714.0 7.0711-1.4645 8.5355C19.0711 22 16.714 22 12 22c-4.71405.0-7.07107.0-8.53553-1.4645C2 19.0711 2 16.714 2 12z" stroke="currentcolor" stroke-width="1.5"/><path d="M2 13H5.16026c.90517.0 1.35776.0 1.75558.183.39783.1829.69237.5266 1.28145 1.2138L8.80271 15.1032C9.39179 15.7904 9.68633 16.1341 10.0842 16.317 10.482 16.5 10.9346 16.5 11.8397 16.5H12.1603C13.0654 16.5 13.518 16.5 13.9158 16.317 14.3137 16.1341 14.6082 15.7904 15.1973 15.1032L15.8027 14.3968C16.3918 13.7096 16.6863 13.3659 17.0842 13.183 17.482 13 17.9346 13 18.8397 13H22" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"/><path d="M8 7h8" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"/><path d="M10 10.5h4" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"/></svg></a></div></footer></article></main><footer class=footer><span>Content under license <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>